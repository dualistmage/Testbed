
#include <sf1v5/common/ResultType.h>
#include <sf1v5/query-manager/ActionItem.h>

#include <wiselib/ustring/UString.h>
#include <cache/MLRUCache.h>

#include <iostream>

using namespace std;
using namespace sf1v5;

typedef KeywordSearchActionItem KeyType;
typedef std::pair< KeywordSearchResultFromSIA , KeywordSearchResultFromMIA > ValueType;
typedef izenelib::am::cccr_hash<KeyType , ValueType> CCCR_Hash_Type;
typedef izenelib::cache::MLRUCache<KeyType, ValueType, CCCR_Hash_Type, izenelib::util::ReadWriteLock> Cache_Type;
Cache_Type cacheMap_;

int main()
{
    std::pair<KeywordSearchResultFromSIA , KeywordSearchResultFromMIA> result;
    std::vector< std::vector<wiselib::UString> >& rawTextOfDocuments( result.first.rawTextOfDocument_ );

    for(size_t i = 0; i < 2; i++)
    {
        std::vector<wiselib::UString> rawVector;
        for(size_t j = 0; j < 20; j++)
        {
            std::string test("MLRUCache Test - This is the string which can be used to insert into UString.");
            wiselib::UString testUString( test , wiselib::UString::UTF_8 );
            rawVector.push_back( testUString );
        }
        rawTextOfDocuments.push_back( rawVector );
    }

    KeywordSearchActionItem actionItem;
    actionItem.collectionName_ = "10K_E";

    // -------- [ Here is the problem ]
    //cacheMap_.insertValue( actionItem , result );
    
    std::string convertString;
    rawTextOfDocuments[1][0].convertString( convertString , wiselib::UString::UTF_8 );
    cout << "Result : " << convertString << endl;

} // end - main()
